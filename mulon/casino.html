<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Casino - Mulon</title>
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/casino.css">
  <link rel="stylesheet" href="../css/standard.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <a href="index.html" class="logo">
        <span class="logo-text">Mulon (beta)</span>
      </a>
      <div class="search-box">
        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.3-4.3"></path>
        </svg>
        <input type="text" placeholder="Search games...">
      </div>
    </div>
    <div class="header-right">
      <div class="balance-display">
        <div class="balance-item">
          <span class="balance-label">Balance</span>
          <span class="balance-amount" id="userBalance">$500.00</span>
        </div>
        <div class="balance-divider"></div>
        <div class="balance-item">
          <span class="balance-label">Portfolio</span>
          <span class="balance-amount portfolio-value" id="portfolioValue">$0.00</span>
        </div>
        <div class="balance-divider"></div>
        <div class="balance-item keys-item">
          <span class="balance-label">Keys <span class="keys-info-btn" id="keysInfoBtn">?</span></span>
          <span class="balance-amount keys-amount" id="userKeys"><img src="/bp/EE/assets/ouths/key.png" alt="" class="key-icon"> 15</span>
          <div class="keys-tooltip" id="keysTooltip">
            <h4><img src="/bp/EE/assets/ouths/key.png" alt="" class="key-icon"> Keys</h4>
            <p>Keys are a special currency that can be used for:</p>
            <ul>
              <li>Playing casino games</li>
              <li>Buying collectables</li>
            </ul>
            <p style="margin-top: 8px;"><strong>Earn Keys:</strong></p>
            <ul>
              <li>+3 keys for every winning prediction</li>
              <li>+1 key per day (daily login)</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="user-menu" id="userMenu">
        <div class="user-avatar" id="userAvatar">
          <span id="userInitials">?</span>
        </div>
        <div class="user-dropdown" id="userDropdown">
          <div class="user-info" id="userInfo">
            <span class="user-name" id="userName">Guest</span>
            <span class="user-email" id="userEmail">Not signed in</span>
          </div>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item signin" id="headerSignInBtn">
            <svg viewBox="0 0 24 24" width="16" height="16">
              <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
            </svg>
            Sign In
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="nav">
    <div class="nav-inner">
      <ul class="nav-links">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="index.html?cat=all" class="nav-link">All Markets</a></li>
        <li><a href="leaderbaord.html" class="nav-link">Leaderboard</a></li>
        <li><a href="casino.html" class="nav-link active">Casino</a></li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Casino Header -->
    <div class="casino-header">
      <h1>üé∞ Casino</h1>
      <p>Play games with your Mulon balance and try your luck!</p>
    </div>

    <!-- Games Grid -->
    <div class="games-grid">
      <!-- Plinko Game Card -->
      <a href="casino/plinko.html" class="game-card">
        <div class="game-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="4" r="2"></circle>
            <circle cx="6" cy="8" r="1.5"></circle>
            <circle cx="12" cy="8" r="1.5"></circle>
            <circle cx="18" cy="8" r="1.5"></circle>
            <circle cx="4" cy="12" r="1.5"></circle>
            <circle cx="9" cy="12" r="1.5"></circle>
            <circle cx="15" cy="12" r="1.5"></circle>
            <circle cx="20" cy="12" r="1.5"></circle>
            <circle cx="6" cy="16" r="1.5"></circle>
            <circle cx="12" cy="16" r="1.5"></circle>
            <circle cx="18" cy="16" r="1.5"></circle>
            <path d="M3 20h18" stroke-width="2"></path>
          </svg>
        </div>
        <div class="game-info">
          <h3>Plinko</h3>
          <p>Drop the ball and watch it bounce through the pegs!</p>
        </div>
        <div class="game-meta">
          <span class="game-tag">üî• Popular</span>
          <span class="game-multiplier">Up to 1000x</span>
        </div>
      </a>

      <!-- Gems Game Card -->
      <a href="casino/gems.html" class="game-card">
        <div class="game-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M6 3h12l4 6-10 13L2 9z"></path>
            <path d="M12 22V9"></path>
            <path d="M2 9h20"></path>
            <path d="M6 3l6 6 6-6"></path>
          </svg>
        </div>
        <div class="game-info">
          <h3>Gems</h3>
          <p>Find the gems and avoid the mines to multiply your bet!</p>
        </div>
        <div class="game-meta">
          <span class="game-tag">üíé New</span>
          <span class="game-multiplier">Up to 24x</span>
        </div>
      </a>

      <!-- Dragon Tower Game Card -->
      <a href="casino/dragon-tower.html" class="game-card">
        <div class="game-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M3 21h18"></path>
            <path d="M5 21V7l7-4 7 4v14"></path>
            <path d="M9 21v-4h6v4"></path>
            <path d="M9 9h.01M15 9h.01M9 13h.01M15 13h.01"></path>
            <path d="M12 3v2"></path>
          </svg>
        </div>
        <div class="game-info">
          <h3>Dragon Tower</h3>
          <p>Climb the tower by choosing the right path. One wrong step and you fall!</p>
        </div>
        <div class="game-meta">
          <span class="game-tag">üêâ New</span>
          <span class="game-multiplier">Up to 5000x</span>
        </div>
      </a>

      <!-- Coming Soon Cards -->
      <div class="game-card coming-soon">
        <div class="game-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="2" y="4" width="20" height="16" rx="2"></rect>
            <path d="M12 8v4l2 2"></path>
          </svg>
        </div>
        <div class="game-info">
          <h3>Slots</h3>
          <p>Classic slot machine experience</p>
        </div>
        <div class="game-meta">
          <span class="game-tag coming-soon-tag">Coming Soon</span>
        </div>
      </div>

      <div class="game-card coming-soon">
        <div class="game-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
          </svg>
        </div>
        <div class="game-info">
          <h3>Dice</h3>
          <p>Roll the dice, predict the outcome</p>
        </div>
        <div class="game-meta">
          <span class="game-tag coming-soon-tag">Coming Soon</span>
        </div>
      </div>

      <div class="game-card coming-soon">
        <div class="game-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 2a10 10 0 0 1 0 20"></path>
            <path d="M12 6v6l4 2"></path>
          </svg>
        </div>
        <div class="game-info">
          <h3>Roulette</h3>
          <p>Spin the wheel, place your bets</p>
        </div>
        <div class="game-meta">
          <span class="game-tag coming-soon-tag">Coming Soon</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-inner">
      <span class="footer-logo">Mulon</span>
      <span class="footer-text">¬© 2026 Mulon Markets. For educational use only.</span>
    </div>
  </footer>

  <script type="module">
    import { UserData } from './js/data.js';
    import { CasinoData } from './casino/js/casino-data.js';
    
    // User menu dropdown toggle
    const userMenu = document.getElementById('userMenu');
    const userDropdown = document.getElementById('userDropdown');
    
    if (userMenu && userDropdown) {
      userMenu.addEventListener('click', (e) => {
        e.stopPropagation();
        userDropdown.classList.toggle('show');
      });
      
      document.addEventListener('click', () => {
        userDropdown.classList.remove('show');
      });
    }
    
    // Initialize auth and update balance display
    async function initCasinoAuth() {
      await Auth.init();
      
      // Update sign in button
      const signInBtn = document.getElementById('headerSignInBtn');
      if (signInBtn) {
        signInBtn.addEventListener('click', async () => {
          const result = await Auth.signIn();
          if (result.success) {
            updateUI();
          }
        });
      }
      
      Auth.onAuthStateChange((user) => {
        updateUI();
      });
    }
    
    function updateUI() {
      const user = Auth.currentUser;
      const balance = UserData.getBalance();
      const keys = UserData.getKeys();
      
      // Update balance display
      const balanceEl = document.getElementById('userBalance');
      if (balanceEl) {
        balanceEl.textContent = '$' + balance.toFixed(2);
      }

      // Update keys display
      const keyEL = document.getElementById('userKeys');
      if (keyEL) {
        keyEL.textContent = keys;
      }
      
      // Update user info
      const userName = document.getElementById('userName');
      const userEmail = document.getElementById('userEmail');
      const userInitials = document.getElementById('userInitials');
      const signInBtn = document.getElementById('headerSignInBtn');
      
      if (user) {
        if (userName) userName.textContent = user.displayName || 'User';
        if (userEmail) userEmail.textContent = user.email || '';
        if (userInitials) userInitials.textContent = (user.displayName || user.email || '?')[0].toUpperCase();
        if (signInBtn) signInBtn.textContent = 'Sign Out';
        if (signInBtn) {
          signInBtn.onclick = async () => {
            await Auth.signOut();
            location.reload();
          };
        }
      } else {
        if (userName) userName.textContent = 'Guest';
        if (userEmail) userEmail.textContent = 'Not signed in';
        if (userInitials) userInitials.textContent = '?';
        if (signInBtn) signInBtn.textContent = 'Sign In';
      }
    }
    
    initCasinoAuth();
  </script>
</body>
</html>
